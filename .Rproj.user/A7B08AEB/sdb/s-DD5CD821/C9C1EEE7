{
    "contents" : "library(shiny)#I wonder why this is here?\nlibrary(gdata) #Used for read.xls function\nlibrary(reshape2)\nlibrary(ggplot2)#ggplot function\nsource(\"main.R\")#Source for our reliabilty models\n\n\nshinyServer(function(input, output) {#reactive shiny fuction\n  \n  reliability <- new.env()\n  Subsystem <- reactive({\n    \n              #Subsystem1\n               reliability$sub1$Reliability_Investment <- seq(0, input$Reliability_Investment_input1, by = 1000)\n               reliability$sub1$MTTF <- MTTF_Function(reliability$sub1$Reliability_Investment,input$C01,input$Cost_Increment1,input$Amode_fail_rate1,input$Bmode_fail_rate1,input$Bmode_FEF1)\n               reliability$sub1$minunit <- repParts(input$Ttime1,reliability$sub1$MTTF)\n               reliability$sub1$cst <- Cost(reliability$sub1$minunit, input$Ci1)\n               reliability$sub1$Aff <- AFF(input$Ci1, reliability$sub1$cst)\n               reliability$sub1$numUnits <- NumUnits(1000000000,reliability$sub1$Reliability_Investment,reliability$sub1$cst)\n              #Subsystem2\n               reliability$sub2$Reliability_Investment <- seq(0, input$Reliability_Investment_input2, by = 1000)\n               reliability$sub2$MTTF <- MTTF_Function(reliability$sub2$Reliability_Investment,input$C02,input$Cost_Increment2,input$Amode_fail_rate2,input$Bmode_fail_rate2,input$Bmode_FEF2)\n               reliability$sub2$minunit <- repParts(input$Ttime2,reliability$sub2$MTTF)\n               reliability$sub2$cst <- Cost(reliability$sub2$minunit, input$Ci2)\n               reliability$sub2$Aff <- AFF(input$Ci2, reliability$sub2$cst)\n               reliability$sub2$numUnits <- NumUnits(1000000000,reliability$sub2$Reliability_Investment,reliability$sub2$cst)\n              #Unit\n               reliability$unitCost <- UnitCost(reliability$sub1$cst,reliability$sub2$cst)\n               reliability$unitInvestment <- UnitInvestment(reliability$sub1$Reliability_Investment,reliability$sub2$Reliability_Investment)\n               reliability$numUnits <- NumUnits(1000000000,reliability$unitInvestment,reliability$unitCost)\n               reliability\n\n\n    \n  })\n  \n  Reliability <- reactive({\n    i=as.integer(input$subsystem)\n    reli <- new.env()\n    switch(input$panelName,\n           \"subsystem 1\" = {reli = Subsystem()$sub1},\n           \"subsystem 2\" = {reli = Subsystem()$sub2},\n            \"3\" = {reli = Subsystem()$sub3},\n            \"4\" = {reli = Subsystem()$sub4})\n    reli\n  })\n  \n  output$MTTF <- renderPlot({ #reactive function, basically Main()\n    p <- qplot(Reliability()$Reliability_Investment,Reliability()$MTTF)\n    p\n  })\n  output$repParts <- renderPlot({ \n    p <- qplot(Reliability()$Reliability_Investment,Reliability()$minunit)\n    p\n  })\n  output$Cost <- renderPlot({ \n    if (is.null(Subsystem()$sub2$cst)){\n      plot_data <- data.frame(x = Reliability()$Reliability_Investment, \"Subsystem 1\" = Subsystem()$sub1$cst)\n    }\n    else{\n      plot_data <- data.frame(x = Reliability()$Reliability_Investment, \"Subsystem 1\" = Subsystem()$sub1$cst, \"Subsystem 2\" = Subsystem()$sub2$cst)\n    }\n    plot_data_long <- melt(plot_data, id = \"x\")\n    p <- ggplot(data = plot_data_long, aes(x = x, y = value, colour = variable)) + geom_point() +ylab(\"Cost\")+ xlab(\"Reliability Investment\")\n    p\n  })\n  output$fleetSize <- renderPlot({ \n    X <- if(Subsystem()$sub1$Reliability_investment[length(Subsystem()$sub1$Reliability_investment)] > Subsystem()$sub2$Reliability_investment[length(Subsystem()$sub2$Reliability_investment)]) Subsystem()$sub1$Reliability_investment else Subsystem()$sub2$Reliability_investment\n    if(length(X) > length(Subsystem()$sub1$numUnits)){\n    for(i in length(Subsystem()$sub1$numUnits)+1:length(X)){\n      Subsystem()$sub1$numUnits[i] <- NA\n    \n    }}\n    plot_data <- data.frame(x = X, \"Subsystem 1\" = Subsystem()$sub1$numUnits, \"Subsystem 2\" = Subsystem()$sub2$numUnits)\n    plot_data_long <- melt(plot_data, id = \"x\")\n    p <- ggplot(data = plot_data_long, aes(x = x, y = value, colour = variable)) + geom_point() +ylab(\"Units\")+ xlab(\"Reliability Investment\")\n    p\n  })\n  output$Aff <- renderPlot({ \n    p <- qplot(Reliability()$Reliability_Investment,Reliability()$Aff)\n    p\n  })\n  \n  \n  \n  output$MTTF_Output<-  renderText({\n   Reliability()$numUnits\n  })\n  output$ui <- renderUI({\n    \n  })\n  \n  \n  \n  \n})\n",
    "created" : 1435830626504.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1846396120",
    "id" : "C9C1EEE7",
    "lastKnownWriteTime" : 1436290421,
    "path" : "~/r/Reliability/server.R",
    "project_path" : "server.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}